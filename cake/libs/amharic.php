<?php
class Amharic {
	
	function encode_amharic($str) {
		$out = '';
		$amharic_array = array(
			"4969" => "፩", "4970" => "፪", "4971" => "፫", "4972" => "፬", "4973" => "፭", "4974" => "፮", 
			"4975" => "፯", "4976" => "፰", "4977" => "፱", "4978" => "፲", "4979" => "፳", "4980" => "፴", 
			"4981" => "፵", "4982" => "፶", "4983" => "፷", "4984" => "፸", "4985" => "፹", "4986" => "፺", 
			"4987" => "፻", "4988" => "፼", "4608" => "ሀ", "4609" => "ሁ", "4610" => "ሂ", "4611" => "ሃ", 
			"4612" => "ሄ", "4613" => "ህ", "4614" => "ሆ", "4615" => "ሇ", "4616" => "ለ", "4617" => "ሉ", 
			"4618" => "ሊ", "4619" => "ላ", "4620" => "ሌ", "4621" => "ል", "4622" => "ሎ", "4623" => "ሏ", 
			"4624" => "ሐ", "4625" => "ሑ", "4626" => "ሒ", "4627" => "ሓ", "4628" => "ሔ", "4629" => "ሕ", 
			"4630" => "ሖ", "4731" => "ሗ", "4632" => "መ", "4633" => "ሙ", "4634" => "ሚ", "4635" => "ማ", 
			"4636" => "ሜ", "4637" => "ም", "4638" => "ሞ", "4639" => "ሟ", "4640" => "ሠ", "4641" => "ሡ", 
			"4642" => "ሢ", "4643" => "ሣ", "4644" => "ሤ", "4645" => "ሥ", "4646" => "ሦ", "4647" => "ሧ", 
			"4648" => "ረ", "4649" => "ሩ", "4650" => "ሪ", "4651" => "ራ", "4652" => "ሬ", "4653" => "ር", 
			"4654" => "ሮ", "4655" => "ሯ", "4656" => "ሰ", "4657" => "ሱ", "4658" => "ሲ", "4659" => "ሳ", 
			"4660" => "ሴ", "4661" => "ስ", "4662" => "ሶ", "4663" => "ሷ", "4664" => "ሸ", "4665" => "ሹ", 
			"4666" => "ሺ", "4667" => "ሻ", "4668" => "ሼ", "4669" => "ሽ", "4670" => "ሾ", "4671" => "ሿ", 
			"4672" => "ቀ", "4673" => "ቁ", "4685" => "ቍ", "4674" => "ቂ", "4682" => "ቊ", "4675" => "ቃ", 
			"4676" => "ቄ", "4680" => "ቈ", "4677" => "ቅ", "4678" => "ቆ", "4683" => "ቋ", "4688" => "ቐ", 
			"4689" => "ቑ", "4701" => "ቝ", "4690" => "ቒ", "4698" => "ቚ", "4691" => "ቓ", "4692" => "ቔ", 
			"4696" => "ቔ", "4693" => "ቕ", "4694" => "ቖ", "4699" => "ቛ", "4704" => "በ", "4705" => "ቡ", 
			"4706" => "ቢ", "4707" => "ባ", "4708" => "ቤ", "4709" => "ብ", "4710" => "ቦ", "4711" => "ቧ", 
			"4720" => "ተ", "4721" => "ቱ", "4722" => "ቲ", "4723" => "ታ", "4724" => "ቴ", "4725" => "ት", 
			"4726" => "ቶ", "4727" => "ቷ", "4728" => "ቸ", "4729" => "ቹ", "4730" => "ቺ", "4731" => "ቻ", 
			"4732" => "ቼ", "4733" => "ች", "4734" => "ቾ", "4735" => "ቿ", "4736" => "ኀ", "4737" => "ኁ", 
			"4738" => "ኂ", "4739" => "ኃ", "4740" => "ኄ", "4741" => "ኅ", "4742" => "ኆ", "4747" => "ኋ", 
			"4752" => "ነ", "4753" => "ኑ", "4754" => "ኒ", "4755" => "ና", "4756" => "ኔ", "4757" => "ን", 
			"4758" => "ኖ", "4759" => "ኗ", "4760" => "ኘ", "4761" => "ኙ", "4762" => "ኚ", "4763" => "ኛ", 
			"4764" => "ኜ", "4765" => "ኝ", "4766" => "ኞ", "4767" => "ኟ", "4768" => "አ", "4769" => "ኡ", 
			"4770" => "ኢ", "4771" => "ኣ", "4772" => "ኤ", "4773" => "እ", "4774" => "ኦ", "4775" => "ኧ", 
			"4776" => "ከ", "4777" => "ኩ", "4778" => "ኪ", "4779" => "ካ", "4780" => "ኬ", "4781" => "ክ", 
			"4782" => "ኮ", "4784" => "ኰ", "4786" => "ኲ", "4787" => "ኳ", "4788" => "ኴ", "4789" => "ኵ", 
			"4792" => "ኸ", "4793" => "ኹ", "4805" => "ዅ", "4794" => "ኺ", "4802" => "ዂ", "4795" => "ኻ", 
			"4796" => "ኼ", "4797" => "ኽ", "4798" => "ኾ", "4800" => "ዀ", "4803" => "ዃ", "4804" => "ዄ", 
			"4808" => "ወ", "4809" => "ዉ", "4810" => "ዊ", "4811" => "ዋ", "4812" => "ዌ", "4813" => "ው", 
			"4814" => "ዎ", "4815" => "ዏ", "4816" => "ዐ", "4817" => "ዑ", "4818" => "ዒ", "4819" => "ዓ", 
			"4820" => "ዔ", "4821" => "ዕ", "4822" => "ዖ", "4824" => "ዘ", "4825" => "ዙ", "4826" => "ዚ", 
			"4827" => "ዛ", "4828" => "ዜ", "4829" => "ዝ", "4830" => "ዞ", "4831" => "ዟ", "4832" => "ዠ", 
			"4833" => "ዡ", "4834" => "ዢ", "4835" => "ዣ", "4836" => "ዤ", "4837" => "ዥ", "4838" => "ዦ", 
			"4839" => "ዧ", "4840" => "የ", "4841" => "ዩ", "4842" => "ዪ", "4843" => "ያ", "4844" => "ዬ", 
			"4845" => "ይ", "4846" => "ዮ", "4848" => "ደ", "4849" => "ዱ", "4850" => "ዲ", "4851" => "ዳ", 
			"4852" => "ዴ", "4853" => "ድ", "4854" => "ዶ", "4855" => "ዷ", "4856" => "ዸ", "4857" => "ዹ", 
			"4858" => "ዺ", "4859" => "ዻ", "4860" => "ዼ", "4861" => "ዽ", "4862" => "ዾ", "4863" => "ዿ", 
			"4864" => "ጀ", "4865" => "ጁ", "4866" => "ጂ", "4867" => "ጃ", "4868" => "ጄ", "4869" => "ጅ", 
			"4870" => "ጆ", "4871" => "ጇ", "4872" => "ገ", "4885" => "ጕ", "4873" => "ጉ", "4874" => "ጊ", 
			"4882" => "ጒ", "4875" => "ጋ", "4876" => "ጌ", "4884" => "ጔ", "4877" => "ግ", "4878" => "ጎ", 
			"4880" => "ጐ", "4883" => "ጓ", "4888" => "ጘ", "4889" => "ጙ", "4890" => "ጚ", "4891" => "ጛ", 
			"4892" => "ጜ", "4893" => "ጝ", "4894" => "ጞ", "4896" => "ጠ", "4897" => "ጡ", "4898" => "ጢ", 
			"4899" => "ጣ", "4900" => "ጤ", "4901" => "ጥ", "4902" => "ጦ", "4903" => "ጧ", "4904" => "ጨ", 
			"4905" => "ጩ", "4906" => "ጪ", "4907" => "ጫ", "4908" => "ጬ", "4909" => "ጭ", "4910" => "ጮ", 
			"4911" => "ጯ", "4912" => "ጰ", "4913" => "ጱ", "4914" => "ጲ", "4915" => "ጳ", "4916" => "ጴ", 
			"4917" => "ጵ", "4918" => "ጶ", "4919" => "ጷ", "4920" => "ጸ", "4921" => "ጹ", "4922" => "ጺ", 
			"4923" => "ጻ", "4924" => "ጼ", "4925" => "ጽ", "4926" => "ጾ", "4928" => "ፀ", "4929" => "ፁ", 
			"4930" => "ፂ", "4931" => "ፃ", "4932" => "ፄ", "4933" => "ፅ", "4934" => "ፆ", "4936" => "ፈ", 
			"4937" => "ፉ", "4938" => "ፊ", "4939" => "ፋ", "4940" => "ፌ", "4941" => "ፍ", "4942" => "ፎ", 
			"4943" => "ፏ", "4944" => "ፐ", "4945" => "ፑ", "4946" => "ፒ", "4947" => "ፓ", 
			"4948" => "ፔ", "4949" => "ፕ", "4950" => "ፖ", "4712" => "ቨ", "4713" => "ቩ", "4714" => "ቪ", 
			"4715" => "ቫ", "4716" => "ቬ", "4717" => "ቭ", "4718" => "ቮ", "4719" => "ቯ", 
			"4961" => "፡", "4962" => "።", "4963" => "፣", "4964" => "፤", "4965" => "፥", 
			"4966" => "፦", "4967" => "፧", "4968" => "፨", "!" => "!", '"' => '"', 
			"#" => "#", "$" => "$", "%" => "%", 
			"0038" => "&", "'" => "'", "(" => "(", ")" => ")", "*" => "*", 
			"+" => "+", "," => ",", "-" => "-", "." => ".", "/" => "/", 
			"0" => "0", "1" => "1", "2" => "2", "3" => "3", "4" => "4", 
			"5" => "5", "6" => "6", "7" => "7", "8" => "8", "9" => "9", 
			":" => ":", ";" => ";", "<" => "<", "=" => "=", ">" => ">", 
			"?" => "?", "@" => "@", "A" => "A", "B" => "B", "C" => "C", 
			"D" => "D", "E" => "E", "F" => "F", "G" => "G", "H" => "H", 
			"I" => "I", "J" => "J", "K" => "K", "L" => "L", "M" => "M", 
			"N" => "N", "O" => "O", "P" => "P", "Q" => "Q", "R" => "R", 
			"S" => "S", "T" => "T", "U" => "U", "V" => "V", "W" => "W", 
			"X" => "X", "Y" => "Y", "Z" => "Z", "[" => "[", "\\" => "\\", 
			"]" => "]", "^" => "^", "_" => "_", "`" => "`", "a" => "a", 
			"b" => "b", "c" => "c", "d" => "d", "e" => "e", "f" => "f", 
			"g" => "g", "h" => "h", "i" => "i", "j" => "j", "k" => "k", 
			"l" => "l", "m" => "m", "n" => "n", "o" => "o", "p" => "p", 
			"q" => "q", "r" => "r", "s" => "s", "t" => "t", "u" => "u", 
			"v" => "v", "w" => "w", "x" => "x", "y" => "y", "z" => "z", 
			"{" => "{", "|" => "|", "}" => "}", "~" => "~", "0153" => "™", 
			"0163" => "£", "0165" => "¥", "0166" => "¦", "0167" => "§", "0169" => "©", 
			"0171" => "«", "0174" => "®");
	
		$arrf = array_flip($amharic_array);
		$pieces = explode(" ", $str);
		
		foreach($pieces as $piece) {
			for($i = 0; $i<strlen($piece); ) {
				if(isset($arrf[substr($piece, $i, 3)])) {
					if(strlen($arrf[substr($piece, $i, 3)]) > 1)
						$out .= '&#' . $arrf[substr($piece, $i, 3)] . ';';
					else
						$out .= $arrf[substr($piece, $i, 3)];
					$i+=3;
				} elseif (isset($arrf[substr($piece, $i, 1)])) {
					if(strlen($arrf[substr($piece, $i, 1)]) == 4)
						$out .= '&#' . $arrf[substr($piece, $i, 1)] . ';';
					else
						$out .= $arrf[substr($piece, $i, 1)];
					$i++;
				}
			}
			$out .= ' ';
		}
		return trim($out, ' ');
	}
	
	function decode_amharic($str) {
		$out = '';
		$amharic_array = array(
			"4969" => "፩", "4970" => "፪", "4971" => "፫", "4972" => "፬", "4973" => "፭", "4974" => "፮", 
			"4975" => "፯", "4976" => "፰", "4977" => "፱", "4978" => "፲", "4979" => "፳", "4980" => "፴", 
			"4981" => "፵", "4982" => "፶", "4983" => "፷", "4984" => "፸", "4985" => "፹", "4986" => "፺", 
			"4987" => "፻", "4988" => "፼", "4608" => "ሀ", "4609" => "ሁ", "4610" => "ሂ", "4611" => "ሃ", 
			"4612" => "ሄ", "4613" => "ህ", "4614" => "ሆ", "4615" => "ሇ", "4616" => "ለ", "4617" => "ሉ", 
			"4618" => "ሊ", "4619" => "ላ", "4620" => "ሌ", "4621" => "ል", "4622" => "ሎ", "4623" => "ሏ", 
			"4624" => "ሐ", "4625" => "ሑ", "4626" => "ሒ", "4627" => "ሓ", "4628" => "ሔ", "4629" => "ሕ", 
			"4630" => "ሖ", "4731" => "ሗ", "4632" => "መ", "4633" => "ሙ", "4634" => "ሚ", "4635" => "ማ", 
			"4636" => "ሜ", "4637" => "ም", "4638" => "ሞ", "4639" => "ሟ", "4640" => "ሠ", "4641" => "ሡ", 
			"4642" => "ሢ", "4643" => "ሣ", "4644" => "ሤ", "4645" => "ሥ", "4646" => "ሦ", "4647" => "ሧ", 
			"4648" => "ረ", "4649" => "ሩ", "4650" => "ሪ", "4651" => "ራ", "4652" => "ሬ", "4653" => "ር", 
			"4654" => "ሮ", "4655" => "ሯ", "4656" => "ሰ", "4657" => "ሱ", "4658" => "ሲ", "4659" => "ሳ", 
			"4660" => "ሴ", "4661" => "ስ", "4662" => "ሶ", "4663" => "ሷ", "4664" => "ሸ", "4665" => "ሹ", 
			"4666" => "ሺ", "4667" => "ሻ", "4668" => "ሼ", "4669" => "ሽ", "4670" => "ሾ", "4671" => "ሿ", 
			"4672" => "ቀ", "4673" => "ቁ", "4685" => "ቍ", "4674" => "ቂ", "4682" => "ቊ", "4675" => "ቃ", 
			"4676" => "ቄ", "4680" => "ቈ", "4677" => "ቅ", "4678" => "ቆ", "4683" => "ቋ", "4688" => "ቐ", 
			"4689" => "ቑ", "4701" => "ቝ", "4690" => "ቒ", "4698" => "ቚ", "4691" => "ቓ", "4692" => "ቔ", 
			"4696" => "ቔ", "4693" => "ቕ", "4694" => "ቖ", "4699" => "ቛ", "4704" => "በ", "4705" => "ቡ", 
			"4706" => "ቢ", "4707" => "ባ", "4708" => "ቤ", "4709" => "ብ", "4710" => "ቦ", "4711" => "ቧ", 
			"4720" => "ተ", "4721" => "ቱ", "4722" => "ቲ", "4723" => "ታ", "4724" => "ቴ", "4725" => "ት", 
			"4726" => "ቶ", "4727" => "ቷ", "4728" => "ቸ", "4729" => "ቹ", "4730" => "ቺ", "4731" => "ቻ", 
			"4732" => "ቼ", "4733" => "ች", "4734" => "ቾ", "4735" => "ቿ", "4736" => "ኀ", "4737" => "ኁ", 
			"4738" => "ኂ", "4739" => "ኃ", "4740" => "ኄ", "4741" => "ኅ", "4742" => "ኆ", "4747" => "ኋ", 
			"4752" => "ነ", "4753" => "ኑ", "4754" => "ኒ", "4755" => "ና", "4756" => "ኔ", "4757" => "ን", 
			"4758" => "ኖ", "4759" => "ኗ", "4760" => "ኘ", "4761" => "ኙ", "4762" => "ኚ", "4763" => "ኛ", 
			"4764" => "ኜ", "4765" => "ኝ", "4766" => "ኞ", "4767" => "ኟ", "4768" => "አ", "4769" => "ኡ", 
			"4770" => "ኢ", "4771" => "ኣ", "4772" => "ኤ", "4773" => "እ", "4774" => "ኦ", "4775" => "ኧ", 
			"4776" => "ከ", "4777" => "ኩ", "4778" => "ኪ", "4779" => "ካ", "4780" => "ኬ", "4781" => "ክ", 
			"4782" => "ኮ", "4784" => "ኰ", "4786" => "ኲ", "4787" => "ኳ", "4788" => "ኴ", "4789" => "ኵ", 
			"4792" => "ኸ", "4793" => "ኹ", "4805" => "ዅ", "4794" => "ኺ", "4802" => "ዂ", "4795" => "ኻ", 
			"4796" => "ኼ", "4797" => "ኽ", "4798" => "ኾ", "4800" => "ዀ", "4803" => "ዃ", "4804" => "ዄ", 
			"4808" => "ወ", "4809" => "ዉ", "4810" => "ዊ", "4811" => "ዋ", "4812" => "ዌ", "4813" => "ው", 
			"4814" => "ዎ", "4815" => "ዏ", "4816" => "ዐ", "4817" => "ዑ", "4818" => "ዒ", "4819" => "ዓ", 
			"4820" => "ዔ", "4821" => "ዕ", "4822" => "ዖ", "4824" => "ዘ", "4825" => "ዙ", "4826" => "ዚ", 
			"4827" => "ዛ", "4828" => "ዜ", "4829" => "ዝ", "4830" => "ዞ", "4831" => "ዟ", "4832" => "ዠ", 
			"4833" => "ዡ", "4834" => "ዢ", "4835" => "ዣ", "4836" => "ዤ", "4837" => "ዥ", "4838" => "ዦ", 
			"4839" => "ዧ", "4840" => "የ", "4841" => "ዩ", "4842" => "ዪ", "4843" => "ያ", "4844" => "ዬ", 
			"4845" => "ይ", "4846" => "ዮ", "4848" => "ደ", "4849" => "ዱ", "4850" => "ዲ", "4851" => "ዳ", 
			"4852" => "ዴ", "4853" => "ድ", "4854" => "ዶ", "4855" => "ዷ", "4856" => "ዸ", "4857" => "ዹ", 
			"4858" => "ዺ", "4859" => "ዻ", "4860" => "ዼ", "4861" => "ዽ", "4862" => "ዾ", "4863" => "ዿ", 
			"4864" => "ጀ", "4865" => "ጁ", "4866" => "ጂ", "4867" => "ጃ", "4868" => "ጄ", "4869" => "ጅ", 
			"4870" => "ጆ", "4871" => "ጇ", "4872" => "ገ", "4885" => "ጕ", "4873" => "ጉ", "4874" => "ጊ", 
			"4882" => "ጒ", "4875" => "ጋ", "4876" => "ጌ", "4884" => "ጔ", "4877" => "ግ", "4878" => "ጎ", 
			"4880" => "ጐ", "4883" => "ጓ", "4888" => "ጘ", "4889" => "ጙ", "4890" => "ጚ", "4891" => "ጛ", 
			"4892" => "ጜ", "4893" => "ጝ", "4894" => "ጞ", "4896" => "ጠ", "4897" => "ጡ", "4898" => "ጢ", 
			"4899" => "ጣ", "4900" => "ጤ", "4901" => "ጥ", "4902" => "ጦ", "4903" => "ጧ", "4904" => "ጨ", 
			"4905" => "ጩ", "4906" => "ጪ", "4907" => "ጫ", "4908" => "ጬ", "4909" => "ጭ", "4910" => "ጮ", 
			"4911" => "ጯ", "4912" => "ጰ", "4913" => "ጱ", "4914" => "ጲ", "4915" => "ጳ", "4916" => "ጴ", 
			"4917" => "ጵ", "4918" => "ጶ", "4919" => "ጷ", "4920" => "ጸ", "4921" => "ጹ", "4922" => "ጺ", 
			"4923" => "ጻ", "4924" => "ጼ", "4925" => "ጽ", "4926" => "ጾ", "4928" => "ፀ", "4929" => "ፁ", 
			"4930" => "ፂ", "4931" => "ፃ", "4932" => "ፄ", "4933" => "ፅ", "4934" => "ፆ", "4936" => "ፈ", 
			"4937" => "ፉ", "4938" => "ፊ", "4939" => "ፋ", "4940" => "ፌ", "4941" => "ፍ", "4942" => "ፎ", 
			"4943" => "ፏ", "4944" => "ፐ", "4945" => "ፑ", "4946" => "ፒ", "4947" => "ፓ", 
			"4948" => "ፔ", "4949" => "ፕ", "4950" => "ፖ", "4712" => "ቨ", "4713" => "ቩ", "4714" => "ቪ", 
			"4715" => "ቫ", "4716" => "ቬ", "4717" => "ቭ", "4718" => "ቮ", "4719" => "ቯ", 
			"4961" => "፡", "4962" => "።", "4963" => "፣", "4964" => "፤", "4965" => "፥", 
			"4966" => "፦", "4967" => "፧", "4968" => "፨", "0033" => "!", "0034" => '"', 
			"#" => "#", "$" => "$", "%" => "%", 
			"0038" => "&", "'" => "'", "(" => "(", ")" => ")", "*" => "*", 
			"+" => "+", "," => ",", "-" => "-", "." => ".", "/" => "/", 
			"0" => "0", "1" => "1", "2" => "2", "3" => "3", "4" => "4", 
			"5" => "5", "6" => "6", "7" => "7", "8" => "8", "9" => "9", 
			":" => ":", ";" => ";", "<" => "<", "=" => "=", ">" => ">", 
			"?" => "?", "@" => "@", "A" => "A", "B" => "B", "C" => "C", 
			"D" => "D", "E" => "E", "F" => "F", "G" => "G", "H" => "H", 
			"I" => "I", "J" => "J", "K" => "K", "L" => "L", "M" => "M", 
			"N" => "N", "O" => "O", "P" => "P", "Q" => "Q", "R" => "R", 
			"S" => "S", "T" => "T", "U" => "U", "V" => "V", "W" => "W", 
			"X" => "X", "Y" => "Y", "Z" => "Z", "[" => "[", "\\" => "\\", 
			"]" => "]", "^" => "^", "_" => "_", "`" => "`", "a" => "a", 
			"b" => "b", "c" => "c", "d" => "d", "e" => "e", "f" => "f", 
			"g" => "g", "h" => "h", "i" => "i", "j" => "j", "k" => "k", 
			"l" => "l", "m" => "m", "n" => "n", "o" => "o", "p" => "p", 
			"q" => "q", "r" => "r", "s" => "s", "t" => "t", "u" => "u", 
			"v" => "v", "w" => "w", "x" => "x", "y" => "y", "z" => "z", 
			"{" => "{", "|" => "|", "}" => "}", "~" => "~", "0153" => "™", 
			"0163" => "£", "0165" => "¥", "0166" => "¦", "0167" => "§", "0169" => "©", 
			"0171" => "«", "0174" => "®");
		$pieces = explode(" ", $str);
		
		foreach($pieces as $piece) {
			for($i = 0; $i<strlen($piece); ) {
				if(substr($piece, $i, 1) == '&'){
					$out .= (isset($amharic_array[substr($piece, $i + 2, 4)]))? $amharic_array[substr($piece, $i + 2, 4)]: '';
					$i+=7;
				} else {
					$out .= (isset($amharic_array[substr($piece, $i, 1)]))? $amharic_array[substr($piece, $i, 1)]: '';
					$i++;
				}
			}
			$out .= ' ';
		}

		return trim($out, ' ');
	}
}
?>